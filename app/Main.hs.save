module Main (main) where

import Lib
import Graphics.UI.Threepenny

main :: IO ()
main = startGUI defaultConfig setup

data Grid = Grid {size::Int,tiles::[(Double,Double)]}

grid

setup window = do
  pos <- liftIO $ newIORef (0,0)
  canv <- canvas
    # set height 400
    # set width 400
    # set style [("border","solid black 1px"),("background","#eee")]

  createGrid canv (0,0)

  on mousemove canv $ \xy ->
    do liftIO $ writeIORef pos xy
  on click canv $ \_ ->
    do (x,y) <- liftIO $ readIORef pos


  getBody window #+ [element canv]
  return ()


createGrid :: Element -> (Double,Double) -> UI ()
createGrid e (x,y) | x < 400 && y < 400 = do
                                       e # set' fillStyle (htmlColor "black")
                                       e # fillRect (x,y) 45 45
                                       createGrid e (x+50,y)
                                       createGrid e (x,y+50)
                         | otherwise = do return ()
